---
title: Junit最佳实践(译)
date: 2018-08-13 18:38:01
tags: [编程语言,测试,Junit,单元测试]
categories: [测试]
---
### 原文
[JUnit Best Practices](http://www.kyleblaney.com/junit-best-practices/)
### 本文针对单元测试的最佳实践目标:
1. 非常快- 你会写很多的单元测试，而且他们会被频繁的运行，所以他们需要运行的很快。我说的是秒级而非毫秒级别的快。
2. 非常可靠- 你希望通过测试找到`production`代码的问题。当且仅当`production`代码被破坏时，测试才失败。有些人认为测试间歇性失败比不测试更问题更严重。

### 1. 保证单元测试只在内存中进行
比如，不要在单元测试中发起HTTP请求、访问数据库、或者读取文件系统。这些行为太慢而且不可靠，所以最好把他们留给其他类型的测试，比如`功能测试`

读取文件系统的测试对单元测试来说太复杂了：
1. 它们需要配置当前的工作目录的位置，要想在开发机器和构建机器上都做好是比较复杂的。
2. 它们通常需要存储在源码管理中的文件，并且保持源码管理中这些文件实时更新是很复杂的。

### 2. 不要跳过单元测试
有许多方式跳过单元测试，但是你不应该这么做：
- 不要使用Junit的`@Ignore`注解
- 不要使用Maven的`maven.skip.test`属性
- 不要使用Maven Surefire插件的`skipTests`属性
- 不要使用Maven Surefire插件的`excludes`属性
被跳过的单元测试不能提供任何好处，但是仍然会被从源码管理中检出和编译。对于不需要的测试，我们应该从源码管理中移除，而不是跳过测试。

### 3. 针对每个单元测试方法只执行一个断言
- 当测试失败时，更容易判断是哪里出了问题。假如一个单元测试有三个断言，我们需要进一步尝试去判断到底是哪个断言失败了。
- 当一个单元测试执行多个断言时，不能保证每个断言都发生。比如一个`unchecked exception`发生，在这个异常之后的所有断言就都不会再出现了，Junit会把这个方法标记为有一个错误然后执行下一个测试方法。
